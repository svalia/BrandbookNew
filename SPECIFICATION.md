# Техническое задание: Система управления брендбуком

## 1. Общее описание
Веб-приложение для создания и управления брендбуками компаний. Система позволяет хранить и управлять всеми элементами фирменного стиля, включая логотипы, цвета, типографику и другие элементы бренда.

## 2. Функциональные требования

### 2.1. Управление брендами
- Создание нового бренда
  - Поле для ввода названия бренда
  - Валидация на непустое название
  - Автоматическая генерация ID бренда на основе timestamp
- Удаление бренда
  - Подтверждение действия через диалоговое окно
  - Каскадное удаление всех связанных данных

### 2.2. Структура данных бренда
Каждый бренд должен содержать следующие секции:
1. Описание бренда
2. Логотипы
3. Цвета и цветовые стили
4. Текстуры
5. Градиенты
6. Типографика
7. Ключевые персонажи/элементы
8. Тональность коммуникации
9. Стандарты сервиса
10. Графические элементы
11. Рекламные материалы
12. Стили бренда

### 2.3. Управление секциями
Каждая секция должна иметь:
- Заголовок
- Кнопку сворачивания/разворачивания (▼)
- Описание с возможностью:
  - Добавления
  - Редактирования
  - Разворачивания/сворачивания длинного текста
  - Сохранения форматирования (переносы строк)
  - У пресетов типографики должно быть описание, с возможностью добавления, редактирования, сворачивания/разворачивания длинного текста и сохранением форматирования, аналогично другим секциям


### 2.4. Работа с логотипами
- Загрузка изображений (PNG, SVG)
- Метаданные логотипа:
  - Название (автогенерация на основе параметров)
  - Цвет (предустановленные + пользовательские)
  - Язык
  - Тип
  - Ориентация
  - Расчётные значения:
    - Ширина иконки (%)
    - Охранное поле (%)
- Предпросмотр загруженного логотипа
- Возможность удаления

### 2.5. Управление типографикой
#### 2.5.1. Управление шрифтами
- Загрузка файлов шрифтов:
  - Поддержка множественной загрузки
  - Указание параметров для каждого файла:
    - Тип начертания:
      - Thin
      - Light
      - Regular
      - Medium
      - Semibold
      - Bold
      - Heavy
      - Thin Italic
      - Light Italic
      - Regular Italic
      - Medium Italic
      - Semibold Italic
      - Bold Italic
      - Heavy Italic
  - Предпросмотр шрифта с его названием
  - Возможность скачивания добавленного шрифта
  - Возможность удаления шрифта
  - Добавленные шрифты становятся доступны для выбора при создании пресетов типографики

#### 2.5.2. Управление пресетами типографики
- Кнопка “Создать пресет”
- При создании пресета:
- Ввод названия пресета
- После создания появляется форма добавления шрифтов в пресет:
  - Выбор семейства шрифта из ранее добавленных шрифтов
  - Указание размера кегля (размер шрифта)
  - Указание межстрочного интервала (line-height)
  - Выбор начертания шрифта (например, Regular, Semibold и др.)
  - Добавленный шрифт отображается в формате:
    - “28/38 · Lead Text Semibold”
    - Где:
      - 28 — размер кегля
      - 38 — межстрочный интервал
      - Lead — название пресета
      - Text Semibold — название шрифта и его начертание
- Внутри пресета:
  - Возможность редактировать параметры добавленных шрифтов (размер, интервал, начертание)
  - Возможность удалять добавленные шрифты
  - Для каждого пресета доступно:
  - Удаление пресета
  - Редактирование описания пресета (как и в других секциях: с возможностью добавления, редактирования, сворачивания/разворачивания длинного текста и сохранением форматирования)

### 2.6. Управление цветами
#### 2.6.1. Основные и дополнительные цвета
- Добавление цветов через HEX-код
- Поддержка множественного добавления через запятую
- Автоматическая конвертация:
  - HEX в RGB
  - RGB в CMYK
- Отображение цвета в виде карточки с:
  - Цветовым кругом
  - Значениями во всех форматах
  - Кнопкой удаления

#### 2.6.2. Парные цвета
- Добавление пар цветов (текст + фон)
- Указание возможности инверсии
- Предпросмотр комбинации
- Отображение всех цветовых значений

#### 2.6.3. Палитры цветов
- Добавление палитр с набором цветов:
  - Ввод HEX-кодов цветов через запятую
  - Автоматическое создание горизонтального ряда цветовых кружков
  - Отображение HEX-кодов под каждым цветом
  - Возможность удаления отдельных цветов из палитры
  - Возможность изменения порядка цветов в палитре
  - Возможность добавления новых цветов в существующую палитру
  - Возможность удаления всей палитры
  - Возможность создания нескольких палитр с разными наборами цветов
  - Автоматическая конвертация цветов:
    - HEX в RGB
    - RGB в CMYK

### 2.6.4. Градиенты
- Добавление градиентов с указанием:
  - Начального цвета (HEX)
  - Конечного цвета (HEX)
  - Типа градиента (линейный, радиальный)
  - Угла наклона (для линейного)
  - Центра (для радиального)
- Автоматическая конвертация цветов:
  - HEX в RGB
  - RGB в CMYK
- Отображение градиента в виде карточки с:
  - Предпросмотром
  - Параметрами градиента
  - Значениями цветов во всех форматах
  - Кнопкой удаления
- Альтернативный способ добавления:
  - Возможность загрузить изображение градиента (SVG или PNG)
  - При загрузке изображения:
    - Предпросмотр изображения градиента
    - Возможность удаления изображения
    - Изображение отображается вместо параметров градиента
    - При загрузке изображения ручной ввод параметров (цвета, тип, угол) становится неактивным
    - При удалении изображения параметры ручного ввода снова активны


### 2.7. Работа с датасетами (для текстур, элементов и других изображений)
- Модальное окно добавления с:
  - Загрузкой изображения
  - Полем для описания
  - Счетчиком символов
  - Предпросмотром
- Отображение в виде галереи карточек
- Управление описанием:
  - Добавление
  - Редактирование
  - Разворачивание/сворачивание
- Возможность удаления

### 2.8. Сохранение и загрузка данных
- Сохранение в JSON-файл
- Загрузка из JSON-файла
- Миграция данных из старых форматов
- Валидация загружаемых данных
- При сохранении данные по загруженным изображениям градиентов сохраняются в base64 формате
- При загрузке JSON-файла система корректно обрабатывает как параметры градиента, так и изображения

## 3. Технические требования

### 3.1. Фронтенд
- Чистый JavaScript без фреймворков
- Bootstrap для стилей и компонентов
- Адаптивный дизайн

### 3.2. Структура данных
```javascript
{
  brands: [
    {
      id: number,
      name: string,
      sections: {
        brandDescription: { description: string },
        logos: {
          description: string,
          items: Array<{
            id: number,
            name: string,
            image: string,
            properties: {
              color: string,
              language: string,
              type: string,
              orientation: string,
              iconWidth: string,
              safeZone: string
            }
          }>
        },
        colors: {
          description: string,
          primary: Array<ColorObject>,
          secondary: Array<ColorObject>,
          paired: Array<PairedColorObject>,
          palettes: Array<ColorPaletteObject>,
          gradients: [
            {
              id: number,
              startColor: {
                hex: string,
                rgb: string,
                cmyk: string
              },
              endColor: {
                hex: string,
                rgb: string,
                cmyk: string
              },
              type: string,
              angle: number,
              center: {
                x: number,
                y: number
              }
            }
          ],
          styles: Array<ColorStyleObject>
        },
        // Аналогичная структура для остальных секций
      }
    }
  ]
}
```

### 3.3. Интерфейс
- Модальные окна для всех форм добавления
- Древовидная структура для отображения брендов
- Карточки для отображения элементов
- Кнопки быстрых действий в каждой секции

### 3.4. Валидация
- Проверка форматов изображений
- Валидация цветовых кодов
- Проверка обязательных полей
- Защита от потери данных

## 4. Требования к оформлению

### 4.1. Общий стиль
- Светлая тема
- Системные шрифты
- Отступы между секциями: 1.5rem
- Тени для карточек и модальных окон

### 4.2. Карточки
- Закругленные углы (0.5rem)
- Легкая тень
- Отступы внутри: 1rem
- Фон: белый

### 4.3. Кнопки
- Primary: синие
- Danger: красные
- Размер: small для большинства действий
- Иконки для основных действий

### 4.4. Анимации
- Плавное сворачивание/разворачивание секций
- Плавное появление модальных окон
- Transition для ховер-эффектов

## 5. Дополнительные требования

### 5.1. Производительность
- Оптимизация изображений
- Ленивая загрузка контента
- Кэширование данных в localStorage

### 5.2. Безопасность
- Валидация загружаемых файлов
- Проверка размера данных
- Санитизация пользовательского ввода

### 5.3. Доступность
- ARIA-атрибуты
- Поддержка клавиатурной навигации
- Читаемые цветовые контрасты

## 6. Зависимости
- Bootstrap 5
- Стандартные браузерные API
  - File API
  - LocalStorage
  - DOM API 

## 7. Справка по работе с системой

### 7.1. Общая инструкция
```
📝 Как работать с брендбуком:
1. Нажмите кнопку "Добавить бренд"
2. Добавьте название бренда
3. В каждой секции:
   - Добавьте описание (если нужно)
   - Добавьте контент (логотипы, цвета, изображения)
   - Используйте кнопки "Развернуть" для просмотра длинных описаний
   - Используйте кнопки "Редактировать" для изменения описаний
```

### 7.2. Структура блоков
```
Бренд
├── Описание бренда
│   └── Описание
├── Логотипы
│   ├── Описание
│   └── Галерея логотипов
├── Цвета и цветовые стили
│   ├── Описание
│   ├── Основные цвета
│   ├── Дополнительные цвета
│   ├── Парные цвета
│   ├── Палитры цветов
│   │   └── Галерея палитр
│   ├── Градиенты
│   └── Типографика
├── Ключевые персонажи/элементы
│   ├── Описание
│   └── Галерея элементов
├── Тональность коммуникации
│   └── Описание
├── Стандарты сервиса
│   └── Описание
├── Графические элементы
│   ├── Описание
│   └── Галерея элементов
├── Рекламные материалы
│   ├── Описание
│   └── Галерея материалов
└── Стили бренда
    ├── Описание
    └── Галерея стилей
```

### 7.3. Работа с JSON файлом

#### 7.3.1. Сохранение данных
- Нажмите кнопку "Сохранить"
- Выберите место сохранения файла
- Файл сохранится в формате JSON с расширением .json
- Все данные, включая изображения, будут закодированы в base64
- Изображения градиентов сохраняются в base64 формате

#### 7.3.2. Загрузка данных
- Используйте кнопку выбора файла
- Выберите ранее сохраненный JSON файл
- Система проверит структуру файла
- При успешной валидации данные будут загружены
- Поддержка градиентов, добавленных как изображение

#### 7.3.3. Структура JSON файла
```javascript
{
  "brands": [
    {
      "id": "timestamp",
      "name": "string",
      "brandDescriptionSection": {
        "description": "string"
      },
      "logosSection": {
        "description": "string",
        "items": []
      },
      "colorsSection": {
        "description": "string",
        "colors": {
          "primary": [],
          "secondary": [],
          "paired": [],
          "palettes": [],
          "gradients": [
            {
      "id": "number",
      "startColor": {
          "hex": "string",
          "rgb": "string",
          "cmyk": "string"
      },
      "endColor": {
          "hex": "string",
          "rgb": "string",
          "cmyk": "string"
      },
      "type": "string",
      "angle": "number",
      "center": {
          "x": "number",
          "y": "number"
      },
      "image": "base64string (если добавлен через изображение)"
}
          ],
          "styles": []
        }
      },
      "texturesSection": {
        "description": "string",
        "items": []
      },
      "typographySection": {
        "description": "string",
        "fonts": [],
        "hierarchy": [],
        "rules": []
      },
      "keyElementsSection": {
        "description": "string",
        "items": []
      },
      "toneOfVoiceSection": {
        "description": "string"
      },
      "serviceStandardsSection": {
        "description": "string"
      },
      "graphicElementsSection": {
        "description": "string",
        "items": []
      },
      "advertisingMaterialsSection": {
        "description": "string",
        "items": []
      },
      "styleGuideSection": {
        "description": "string",
        "items": []
      }
    }
  ]
}
```

### 7.4. Расчётные значения для логотипов

#### 7.4.1. Описание значений
```
1. Половина ширины иконки (%)
   - Это значение используется для правильного позиционирования текста (заголовка и подзаголовка) 
     относительно иконки
   - Текст должен начинаться от середины иконки
   - Вычисляется как процент от общей ширины логотипа
   - При масштабировании логотипа отношение сохраняется, обеспечивая правильное выравнивание текста

2. Охранное поле (%)
   - Вычисляется на основе высоты буквы "Б" относительно общей высоты логотипа
   - Определяет минимальное пространство вокруг логотипа, которое должно оставаться свободным
   - При масштабировании логотипа охранное поле автоматически пропорционально изменяется
   - Сохраняет правильные пропорции защитного пространства
```

#### 7.4.2. Формулы расчёта
```
Половина ширины иконки (%) = (ширина_иконки / общая_ширина_логотипа) * 100 / 2

Охранное поле (%) = (высота_буквы_Б / общая_высота_логотипа) * 100
```

### 7.5. Валидация данных

#### 7.5.1. Проверка изображений
- Допустимые форматы: PNG, SVG
- Максимальный размер файла: определяется браузером
- Проверка MIME-типа перед загрузкой

#### 7.5.2. Проверка цветов
- HEX-код: #RRGGBB (6 символов)
- Валидация формата перед добавлением
- Автоматическая конвертация в верхний регистр

#### 7.5.3. Проверка описаний
- Максимальная длина: 10000 символов
- Сохранение переносов строк
- Поддержка пустых строк

### 7.6. Горячие клавиши и взаимодействие
- Enter: подтверждение действия в модальных окнах
- Esc: закрытие модальных окон
- Tab: навигация по элементам интерфейса
- Ctrl + S: сохранение данных (через системный диалог) 

## 8. Описание форм и модальных окон

### 8.1. Форма добавления бренда
```
Модальное окно "Добавить бренд"
├── Поле "Название бренда"
│   ├── Тип: text
│   ├── Обязательное: да
│   └── Валидация: непустое значение
└── Кнопки
    ├── "Добавить": primary
    └── "Отмена": secondary
```

### 8.2. Форма добавления логотипа
```
Модальное окно "Добавить логотип"
├── Поле "Файл"
│   ├── Тип: file
│   ├── Accept: .png,.svg
│   └── Обязательное: да
├── Поле "Цвет"
│   ├── Тип: select
│   ├── Обязательное: да
│   └── Опции:
│       ├── white (Белый)
│       ├── black (Черный)
│       ├── multicolor (Цветной)
│       └── custom (Пользовательский)
├── Поле "Пользовательский цвет" (появляется если выбран custom)
│   ├── Тип: text
│   └── Placeholder: "Введите название цвета на английском"
├── Поле "Язык"
│   ├── Тип: select
│   ├── Обязательное: да
│   └── Опции:
│       ├── rus (Русский)
│       ├── eng (Английский)
│       └── multi (Общий)
├── Поле "Тип"
│   ├── Тип: select
│   ├── Обязательное: да
│   └── Опции:
│       ├── main (Основной)
│       ├── simple (Упрощенный)
│       └── sign (Знак)
├── Поле "Ориентация"
│   ├── Тип: select
│   ├── Обязательное: да
│   └── Опции:
│       ├── horizontal (Горизонтальный)
│       ├── vertical (Вертикальный)
│       └── square (Квадратный)
├── Поле "Половина ширины иконки (%)"
│   ├── Тип: number
│   ├── Обязательное: да
│   └── Валидация: 0-100
├── Поле "Половина ширины иконки (%)"
│   ├── Тип: number
│   ├── Обязательное: да
│   └── Валидация: 0-100
├── Поле "Охранное поле (%)"
│   ├── Тип: double/float, 3 знака после запятой
│   ├── Обязательное: да
│   └── Валидация: 0-100
└── Кнопки
    ├── "Добавить": primary
    └── "Отмена": secondary
```

### 8.3. Форма добавления цветов
```
Возможно массовое доабвление цветов. Подсказка дял формы:
Введите HEX-код цвета, начиная с символа #. Для добавления нескольких цветов, введите их через запятую (например: #FF0000, #00FF00, #0000FF)
Модальное окно "Добавить цвет"
├── Поле "HEX-коды цветов"
│   ├── Тип: text
│   ├── Обязательное: да
│   ├── Placeholder: "#RRGGBB,#RRGGBB,..."
│   └── Валидация: формат #RRGGBB, разделитель запятая
└── Кнопки
    ├── "Добавить": primary
    └── "Отмена": secondary
```

### 8.4. Форма добавления палитры цветов
- Модальное окно для добавления новой палитры:
  - Поле ввода HEX-кодов цветов через запятую
  - Кнопка "Добавить палитру"
  - Кнопка "Отмена"
- Функциональность:
  - Валидация HEX-кодов
  - Автоматическое создание горизонтального ряда цветовых кружков
  - Отображение HEX-кодов под каждым цветом
  - Возможность удаления отдельных цветов
  - Возможность изменения порядка цветов
  - Возможность добавления новых цветов
  - Возможность удаления всей палитры
  - Возможность создания нескольких палитр

### 8.5. Форма добавления шрифта
```
Модальное окно "Добавить шрифт"
├── Поле "Файл шрифта"
│   ├── Тип: file
│   ├── Accept: .ttf,.otf,.woff,.woff2
│   └── Обязательное: да
├── Поле "Тип начертания"
│   ├── Тип: select
│   ├── Обязательное: да
│   └── Опции:
│       ├── Thin
│       ├── Light
│       ├── Regular
│       ├── Medium
│       ├── Semibold
│       ├── Bold
│       ├── Heavy
│       ├── Thin Italic
│       ├── Light Italic
│       ├── Regular Italic
│       ├── Medium Italic
│       ├── Semibold Italic
│       ├── Bold Italic
│       └── Heavy Italic
├── Секция предпросмотра
│   └── Текст с примером шрифта
└── Кнопки
    ├── "Добавить": primary
    ├── "Добавить еще": secondary
    └── "Отмена": secondary
```

### 8.6. Форма создания типографического стиля
```
Модальное окно "Собрать стиль"
├── Шаг 1
│   ├── Поле "Тип стиля"
│   │   ├── Тип: select
│   │   ├── Обязательное: да
│   │   └── Опции:
│   │       ├── Title
│   │       ├── Lead Text
│   │       ├── Paragraph Text
│   │       ├── Interface Text
│   │       └── Caption/Disclaimer
│   ├── Поле "Семейство шрифтов"
│   │   ├── Тип: select
│   │   ├── Обязательное: да
│   │   └── Опции: [список добавленных семейств]
│   └── Кнопка "Далее"
├── Шаг 2
│   ├── Предпросмотр сгенерированных стилей
│   │   └── Примеры текста во всех размерах
│   └── Кнопки
│       ├── "Сохранить": primary
│       ├── "Назад": secondary
│       └── "Отмена": secondary
```

### 8.7. Форма добавления парных цветов
```
Модальное окно "Добавить парные цвета"
├── Секция "Цвет текста"
│   └── Поле "HEX-код"
│       ├── Тип: text
│       ├── Обязательное: да
│       └── Валидация: формат #RRGGBB
├── Секция "Цвет фона"
│   └── Поле "HEX-код"
│       ├── Тип: text
│       ├── Обязательное: да
│       └── Валидация: формат #RRGGBB
├── Чекбокс "Допустима инверсия"
│   └── Тип: checkbox
└── Кнопки
    ├── "Добавить": primary
    └── "Отмена": secondary
```

### 8.8. Форма добавления градиента
```
Модальное окно “Добавить градиент”
├── Секция “Начальный цвет”
│   └── Поле “HEX-код”
│       ├── Тип: text
│       ├── Обязательное: да
│       └── Валидация: формат #RRGGBB
├── Секция “Конечный цвет”
│   └── Поле “HEX-код”
│       ├── Тип: text
│       ├── Обязательное: да
│       └── Валидация: формат #RRGGBB
├── Поле “Тип градиента”
│   ├── Тип: select
│   ├── Обязательное: да
│   └── Опции:
│       ├── linear (Линейный)
│       └── radial (Радиальный)
├── Поле “Угол наклона” (для линейного)
│   ├── Тип: number
│   ├── Обязательное: да для линейного
│   └── Валидация: 0-360
├── Секция “Центр” (для радиального)
│   ├── Поле “X (%)”
│   │   ├── Тип: number
│   │   ├── Обязательное: да для радиального
│   │   └── Валидация: 0-100
│   └── Поле “Y (%)”
│       ├── Тип: number
│       ├── Обязательное: да для радиального
│       └── Валидация: 0-100
├── Альтернативный способ добавления градиента:
│   └── Поле “Файл изображения градиента”
│       ├── Тип: file
│       ├── Accept: .png, .svg
│       ├── Необязательное поле (альтернатива ручному вводу параметров)
│       ├── При выборе файла параметры ручного ввода становятся неактивными
│       └── При удалении файла параметры ручного ввода снова активны
└── Кнопки
├── “Добавить”: primary
└── “Отмена”: secondary

### 8.9. Форма добавления датасета
```
Можно доабвлять сразу несоклько изображений в набор. При добавлении они добавляются плиткой в форме и в проекте отображаются в сгруппированном виде. Описание может быть как у всего дата сета так и у отдельного изображения.
Модальное окно "Добавить изображение"
├── Поле "Файл"
│   ├── Тип: file
│   ├── Accept: .png,.svg
│   └── Обязательное: да
├── Поле "Название"
│   ├── Тип: textarea
│   ├── Максимальная длина: 10000
│   └── Счетчик символов: да
├── Поле "Описание"
│   ├── Тип: textarea
│   ├── Максимальная длина: 10000
│   └── Счетчик символов: да
├── Секция предпросмотра
│   └── Контейнер для превью изображения
        └── Поле "Описание изображения"
           ├── Тип: textarea
           ├── Максимальная длина: 10000
           └── Счетчик символов: да
└── Кнопки
    ├── "Добавить": primary
    ├── "Добавить еще изображение": primary
    └── "Отмена": secondary
```

### 8.10. Форма редактирования описания
```
Встроенная форма (не модальное окно)
├── Поле "Описание"
│   ├── Тип: textarea
│   ├── Максимальная длина: 10000
│   └── Автоматическое изменение высоты
└── Кнопки
    ├── "Сохранить": primary
    └── "Отмена": secondary
```

### 8.11. Особенности работы форм

#### 8.11.1. Общие правила
- Все формы имеют валидацию на клиентской стороне
- Кнопка "Отмена" закрывает форму без сохранения
- Модальные окна закрываются по Esc или клику вне окна
- Формы отправляются по Enter (кроме textarea)

#### 8.11.2. Автоматические действия
- Предпросмотр изображений при выборе файла
- Обновление счетчика символов при вводе
- Конвертация цветов при добавлении
- Автоматическое форматирование HEX-кодов в верхний регистр

#### 8.11.3. Обработка ошибок
- Визуальная индикация некорректных полей
- Сообщения об ошибках под полями
- Блокировка отправки формы при наличии ошибок
- Сохранение введенных данных при ошибке отправки 

## 9. Стили и классы
```
Для заголовока используй шрифт: SBSansDisplay-SemiBold.woff2
Для основного текста используй шрифт: SBSansText-Regular.woff
Для подсказок и дополнительного текста используй шрифт: SBSansTextComp-ExtraLight.woff2
Шрифты находятся в корневой директории проекта Brandbook2.
.color-palettes-gallery {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-top: 20px;
}
.color-palette {
    background: white;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.color-palette-colors {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 10px;
}
.color-palette-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}
.color-palette-circle {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 1px solid #ddd;
}
.color-palette-hex {
    font-size: 12px;
    color: #666;
}
.color-palette-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}
```
